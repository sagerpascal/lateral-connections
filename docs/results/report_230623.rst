Status 23 June, 2023
====================

Fixed a bug related to the normalisation of the lateral weights.


With Negative Correlation
-------------------------

*TH=0.6*

The image is dominated by the negative correlation between the filters.
Thus, no relation between the channels is learned.

.. image:: /_static/results/230623/1_neg_corr.png
  :width: 800


.. code-block:: python
  :linenos:

  pos_co_activation = torch.matmul(x_out, x_in)
  neg_co_activation = torch.matmul(x_out, 1 - x_in) + torch.matmul(1 - x_out, x_in)
  update = torch.mean(pos_co_activation - neg_co_activation, dim=0)
  update = torch.where(update > 0., update, 0.)
  W.data += lr * update.view(W.shape)


Learned Weights
~~~~~~~~~~~~~~~

.. image:: /_static/results/230623/2_neg_corr_weights.png
  :width: 800



Without L2
~~~~~~~~~~

Straight Line
^^^^^^^^^^^^^

.. image:: /_static/results/230623/3.png
  :width: 800

With Noise
^^^^^^^^^^

.. image:: /_static/results/230623/4.png
  :width: 800

Discontinuous Line
^^^^^^^^^^^^^^^^^^

.. image:: /_static/results/230623/5.png
  :width: 800



With L2
~~~~~~~

Straight Line
^^^^^^^^^^^^^

.. image:: /_static/results/230623/6.png
  :width: 800

With Noise
^^^^^^^^^^

.. image:: /_static/results/230623/7.png
  :width: 800

Discontinuous Line
^^^^^^^^^^^^^^^^^^

.. image:: /_static/results/230623/8.png
  :width: 800






Without Negative Correlation
----------------------------

*TH=0.7*

.. code-block:: python
  :linenos:

  pos_co_activation = torch.matmul(x_out, x_in)
  update = torch.mean(pos_co_activation, dim=0)
  update = torch.where(update > 0., update, 0.)
  W.data += lr * update.view(W.shape)


Learned Weights
~~~~~~~~~~~~~~~

.. image:: /_static/results/230623/10_no_neg_corr_weights.png
  :width: 800



Without L2
~~~~~~~~~~

Straight Line
^^^^^^^^^^^^^

.. image:: /_static/results/230623/11.png
  :width: 800

With Noise
^^^^^^^^^^

.. image:: /_static/results/230623/12.png
  :width: 800

Discontinuous Line
^^^^^^^^^^^^^^^^^^

.. image:: /_static/results/230623/13.png
  :width: 800




With L2
~~~~~~~

Straight Line
^^^^^^^^^^^^^

.. image:: /_static/results/230623/14.png
  :width: 800

With Noise
^^^^^^^^^^

.. image:: /_static/results/230623/15.png
  :width: 800

Discontinuous Line
^^^^^^^^^^^^^^^^^^

.. image:: /_static/results/230623/16.png
  :width: 800
